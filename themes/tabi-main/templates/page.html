{% extends "base.html" %}

{% block main_content %}
{%- set separator = config.extra.separator | default(value="•") -%}




</pre></div>



    <table>
        <thead>
            <tr>
                <th>setting</th>
                <th>page</th>
                <th>section</th>
                <th>config</th>
                
            </tr>
        </thead>
        <tbody>
            {% for setting in settings_to_test %}
                <tr>
                    <td><code>{{ setting }}</code></td>
                    <td>{{ page.extra[setting] | default(value="⬛") }}</td>
                    <td>{{ current_section.extra[setting] | default(value="⬛") }}</td>
                    <td>{{ config.extra[setting] | default(value="⬛") }}</td>
                 
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{# {{ __tera_context }} #}
{# End debugging #}

<main>
    <article>
        <h1 class="article-title">
            {{ page.title | markdown(inline=true) | safe }}
        </h1>

        <ul class="meta">
            {#- Draft indicator -#}
            {% if page.draft %}
                <li class="draft-label">{{ macros_translate::translate(key="draft", default="DRAFT", language_strings=language_strings) }}</li>
            {% endif %}

            

            {%- set separator_with_class = "<span class='separator' aria-hidden='true'>" ~ separator ~ "</span>"-%}

         

           

        

           
        </ul>

        {#- A page is part of a series if one of the sections above (whether it is transparent or not) has the `extra.series` parameter set to true. -#}
        {#- As a series might be a transparent section in order to mix up its articles with those of the section just above or the root, -#}
        {#- there is no other way but to compute the potential path of each ancestor section related to the page and look for the first one being a series. -#}
        {#- Using the `ancestors` field of a section is not possible because transparent sections are not present in this field. -#}
        {%- set series_path_components = [] -%}
        {%- set section_paths = [] -%}
        {%- for path in page.relative_path | split(pat="/") | slice(end=-1) -%}
            {%- set_global series_path_components = series_path_components | concat(with=path) -%}
            {%- set section_path = series_path_components | concat(with="_index.md") | join(sep="/") -%}
            {%- set_global section_paths = section_paths | concat(with=section_path) -%}
        {%- endfor -%}
        {#- The series the page is part of is the closest section flagged as a series, if any -#}
        {%- for section_path in section_paths | reverse -%}
            {%- set section_file_exists = load_data(path=section_path, required=false) -%}
            {%- if section_file_exists -%}
                {%- set loaded_section = get_section(path=section_path,lang=lang) -%}
                {%- if "series" in loaded_section.extra and loaded_section.extra.series -%}
                    {%- set_global series_section = loaded_section -%}
                    {%- set_global series_ordered_pages = loaded_section.pages -%}
                    {%- if loaded_section.paginated | default(value=0) > 0 and loaded_section.paginate_reversed -%}
                        {%- set_global series_ordered_pages = loaded_section.pages | reverse -%}
                    {%- endif -%}
                    {%- break -%}
                {%- endif -%}
            {%- endif -%}
        {%- endfor -%}

        {% if page.extra.tldr %}
            <div class="admonition note">
                <div class="admonition-icon admonition-icon-note"></div>
                <div class="admonition-content">
                    <strong class="admonition-title">
                        <span title="Too long; didn't read (summary)">TL;DR</span>
                    </strong>
                    <p>{{ page.extra.tldr | markdown | safe }}</p>
                </div>
            </div>
        {% endif %}

       

        <section class="body">
            {#- Replace series_intro placeholder -#}
            {%- set content_with_intro = page.content -%}
            {%- if "<!-- series_intro -->" in page.content -%}
                {%- set series_intro_html = macros_series_page::get_introduction(page=page, series_section=series_section, series_ordered_pages=series_ordered_pages, language_strings=language_strings) -%}
                {%- set content_with_intro = content_with_intro | replace(from="<!-- series_intro -->", to=series_intro_html) -%}
            {%- elif series_section -%}
                {%- set series_intro_html = macros_series_page::get_introduction(page=page, series_section=series_section, series_ordered_pages=series_ordered_pages, language_strings=language_strings) -%}
                {%- set content_with_intro = series_intro_html ~ content_with_intro -%}
            {%- endif -%}

            {#- Handle series_outro placeholder -#}
            {%- set processed_content = content_with_intro -%}
            {%- if "<!-- series_outro -->" in content_with_intro -%}
                {%- set series_outro_html = macros_series_page::get_outro(page=page, series_section=series_section, series_ordered_pages=series_ordered_pages, language_strings=language_strings) -%}
                {%- set processed_content = processed_content | replace(from="<!-- series_outro -->", to=series_outro_html) -%}
            {%- elif series_section -%}
                {%- set series_outro_html = macros_series_page::get_outro(page=page, series_section=series_section, series_ordered_pages=series_ordered_pages, language_strings=language_strings) -%}
                {#- We want the outro at the end of the article, but before footnote definitions -#}
                {%- set footnotes_marker = '<hr><ol class="footnotes-list">' -%}
                {%- if footnotes_marker in content_with_intro -%}
                    {%- set content_sections = processed_content | split(pat=footnotes_marker) -%}
                    {%- set main_content = content_sections | first -%}
                    {%- set footnotes_content = content_sections | slice(start=1) | join(sep=footnotes_marker) -%}
                    {%- set processed_content = main_content ~ series_outro_html ~ footnotes_marker ~ footnotes_content -%}
                {%- else -%}
                    {%- set processed_content = processed_content ~ series_outro_html -%}
                {%- endif -%}
            {%- endif -%}

           
        </section>

       
            
            <nav class="{{ full_width_class | default(value="") }} article-navigation">
                <div>
                {%- if left_link and left_label and left_title -%}
                <a href="{{ left_link | safe }}" aria-label="{{ left_label }}" aria-describedby="left_title"><span class="arrow">←</span>&nbsp;{{ left_label }}</a>
                <p aria-hidden="true" id="left_title">{{ left_title | truncate(length=100, end="…") | markdown(inline=true) | safe }}</p>
                {%- endif -%}
                </div>
                <div>
                {%- if right_link and right_label and right_title -%}
                <a href="{{ right_link | safe }}" aria-label="{{ right_label }}" aria-describedby="right_title">{{ right_label }}&nbsp;<span class="arrow">→</span></a>
                <p aria-hidden="true" id="right_title">{{ right_title | truncate(length=100, end="…") | markdown(inline=true) | safe }}</p>
                {%- endif -%}
                </div>
            </nav>
            {%- endif -%}
        {%- endif -%}

        {#- Comments -#}
        {#- Check if comments are enabled, checking that they are not disabled on the specific page -#}
        {% set systems = ["giscus", "utterances", "hyvortalk", "isso"] %}
        {% set enabled_systems = 0 %}
        {% set comment_system = "" %}

        {% for system in systems %}
            {% set global_enabled = config.extra[system].enabled_for_all_posts | default(value=false) %}
            {% set page_enabled = page.extra[system] | default(value=global_enabled) %}
            {% set is_enabled = global_enabled and page_enabled != false or page_enabled == true %}

            {% if is_enabled %}
                {% set_global comment_system = system %}
                {% set_global enabled_systems = enabled_systems + 1 %}
            {% endif %}
        {% endfor %}
        {#- Ensure only one comment system is enabled -#}
        {% if enabled_systems > 1 %}
            {{ throw(message="ERROR: Multiple comment systems have been enabled for the same page. Check your config.toml and individual page settings to ensure only one comment system is activated at a time.") }}
        {% endif %}
        {% if comment_system %}
            {% include "partials/comments.html" %}
        {% endif %}

    </article>
</main>



{% endblock main_content %}
